<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Projet final_Chichén Itzá</title>

  <!-- A-Frame -->
  <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
<!-- =========================
       COMPOSANTS "BIBLIOTHÈQUE"
       ========================= -->
  <script>
    /**
     * Déplacement clavier relatif à la caméra.
     * - WASD pour se déplacer
     * - SHIFT pour accélérer (optionnel)
     *
     * Appliquer sur l'entité #player.
     */
    AFRAME.registerComponent('player-controller', {
      schema: {
        speed: { type: 'number', default: 3.5 },
        sprintMultiplier: { type: 'number', default: 1.6 }
      },
      init() {
        this.keys = Object.create(null);
        this.tmpVec3 = new THREE.Vector3();
        this.forward = new THREE.Vector3();
        this.right = new THREE.Vector3();

        window.addEventListener('keydown', (e) => { this.keys[e.code] = true; });
        window.addEventListener('keyup',   (e) => { this.keys[e.code] = false; });
      },
      tick(time, dt) {
        const dts = dt / 1000;
        if (!dts) return;

        // Inputs
        let x = 0, z = 0;
        if (this.keys['KeyW']) z -= 1;
        if (this.keys['KeyS']) z += 1;
        if (this.keys['KeyA']) x -= 1;
        if (this.keys['KeyD']) x += 1;

        if (x === 0 && z === 0) return;

        // Normalisation
        const len = Math.hypot(x, z);
        x /= len; z /= len;

        // Direction relative à la caméra (yaw uniquement)
        const cam = this.el.sceneEl.camera;
        if (!cam) return;

        this.forward.set(0, 0, -1).applyQuaternion(cam.quaternion);
        this.forward.y = 0; this.forward.normalize();

        this.right.copy(this.forward).cross(new THREE.Vector3(0, 1, 0)).normalize();

        // Vitesse
        let speed = this.data.speed;
        if (this.keys['ShiftLeft'] || this.keys['ShiftRight']) speed *= this.data.sprintMultiplier;

        // Δpos = right*x + forward*z
        this.tmpVec3.set(0,0,0);
        this.tmpVec3.addScaledVector(this.right, x);
        this.tmpVec3.addScaledVector(this.forward, z);
        this.tmpVec3.multiplyScalar(speed * dts);

        const obj = this.el.object3D;
        obj.position.add(this.tmpVec3);

        // Orienter le joueur dans la direction du mouvement (optionnel, utile en 3e personne)
        const yaw = Math.atan2(this.tmpVec3.x, this.tmpVec3.z);
        obj.rotation.y = yaw;
      }
    });

    /**
     * Caméra 3e personne (orbit souris + follow).
     * - Maintenir clic gauche + bouger la souris pour tourner autour du joueur
     * - La caméra suit la cible en conservant une distance/hauteur
     *
     * Appliquer sur l'entité #camRig.
     */
    AFRAME.registerComponent('third-person-camera', {
      schema: {
        target: { type: 'selector' },
        distance: { type: 'number', default: 4.2 },
        height: { type: 'number', default: 1.8 },
        sensitivity: { type: 'number', default: 0.12 },
        pitchMin: { type: 'number', default: -10 },
        pitchMax: { type: 'number', default: 55 }
      },
      init() {
        this.yaw = 180;   // derrière le joueur au départ
        this.pitch = 15;
        this.dragging = false;

        this.el.sceneEl.addEventListener('renderstart', () => {
          const canvas = this.el.sceneEl.canvas;
          if (!canvas) return;

          canvas.addEventListener('mousedown', (e) => {
            if (e.button !== 0) return;
            this.dragging = true;
          });
          window.addEventListener('mouseup', () => { this.dragging = false; });
          window.addEventListener('mousemove', (e) => {
            if (!this.dragging) return;
            this.yaw   -= e.movementX * this.data.sensitivity;
            this.pitch -= e.movementY * this.data.sensitivity;
            this.pitch = Math.max(this.data.pitchMin, Math.min(this.data.pitchMax, this.pitch));
          });
        });
      },
      tick() {
        const target = this.data.target;
        if (!target) return;

        const t = target.object3D.position;

        const yawRad = THREE.MathUtils.degToRad(this.yaw);
        const pitchRad = THREE.MathUtils.degToRad(this.pitch);

        const r = this.data.distance;
        const cosP = Math.cos(pitchRad);

        const camX = t.x + r * Math.sin(yawRad) * cosP;
        const camY = t.y + this.data.height + r * Math.sin(pitchRad);
        const camZ = t.z + r * Math.cos(yawRad) * cosP;

        this.el.object3D.position.set(camX, camY, camZ);
        this.el.object3D.lookAt(t.x, t.y + this.data.height, t.z);
      }
    });
    /**
     * Utilisation:
     *  info-on-click="panel: #infoPanel; text: #infoValue; lines: phrase1|phrase2|phrase3"
     */
    AFRAME.registerComponent('info-on-click', {
      schema: {
        panel: { type: 'selector' },
        text:  { type: 'selector' },
        lines: { type: 'string', default: '' }
      },
      init() {
        this.index = 0;
        this.lines = (this.data.lines || '').split('|').map(s => s.trim()).filter(Boolean);

        this.el.classList.add('cliquable');

        this.el.addEventListener('click', () => {
          if (!this.data.panel || !this.data.text || this.lines.length === 0) return;

          this.data.panel.setAttribute('visible', true);
          this.data.text.setAttribute('value', this.lines[this.index]);

          this.index = (this.index + 1) % this.lines.length;
        });
      }
    });

    /**
     * PNJ guide: affiche une bulle de dialogue (HUD) avec un script.
     * Utilisation:
     *  guide-dialogue="panel:#dialoguePanel; text:#dialogueValue; lines: a|b|c"
     */
    AFRAME.registerComponent('guide-dialogue', {
      schema: {
        panel: { type: 'selector' },
        text:  { type: 'selector' },
        lines: { type: 'string', default: '' }
      },
      init() {
        this.index = 0;
        this.lines = (this.data.lines || '').split('|').map(s => s.trim()).filter(Boolean);

        this.el.classList.add('cliquable');

        this.el.addEventListener('click', () => {
          if (!this.data.panel || !this.data.text || this.lines.length === 0) return;

          this.index = 0;
          this.data.panel.setAttribute('visible', true);
          this.data.text.setAttribute('value', this.lines[this.index]);
        });

        // Clic sur la bulle = phrase suivante
        if (this.data.panel) {
          this.data.panel.addEventListener('click', () => {
            if (this.lines.length === 0) return;
            this.index = (this.index + 1) % this.lines.length;
            this.data.text.setAttribute('value', this.lines[this.index]);
          });
        }
      }
    });

    /**
     * Boutons "fermer" des panneaux HUD.
     * Utilisation:
     *  hud-close="target: #infoPanel"
     */
    AFRAME.registerComponent('hud-close', {
      schema: { target: { type: 'selector' } },
      init() {
        this.el.classList.add('cliquable');
        this.el.addEventListener('click', () => {
          if (this.data.target) this.data.target.setAttribute('visible', false);
        });
      }
    });

    /**
     * Démo physique minimale (visible immédiatement):
     * - génère 2 objets dynamiques à faire tomber/pousser
     */
    AFRAME.registerComponent('spawn-physics-demo', {
      init() {
        // Créer quelques objets dynamiques dans la scène
        const scene = this.el.sceneEl;

        const makeSphere = (x, y, z) => {
          const s = document.createElement('a-sphere');
          s.setAttribute('radius', '0.25');
          s.setAttribute('color', '#BDBDBD');
          s.setAttribute('position', `${x} ${y} ${z}`);
          s.setAttribute('dynamic-body', 'mass: 1;');
          scene.appendChild(s);
        };

        const makeBox = (x, y, z) => {
          const b = document.createElement('a-box');
          b.setAttribute('depth', '0.35');
          b.setAttribute('height', '0.35');
          b.setAttribute('width', '0.35');
          b.setAttribute('color', '#9E9E9E');
          b.setAttribute('position', `${x} ${y} ${z}`);
          b.setAttribute('dynamic-body', 'mass: 1;');
          scene.appendChild(b);
        };

        makeSphere(1.2, 3.0, -4.0);
        makeBox(-1.0, 3.3, -4.2);
      }
    });
  </script>
</head>

<body>
<!--Scène simplifiée : 
    - Déplacement 3e personne (clavier/souris), relatif à la caméra
    - Physique (système + objets dynamiques)
    - 2 composants mutualisables: info-on-click + guide-dialogue (+ hud-close)
  -->
    <a-scene physics="gravity: -9.8">
  <a-plane position="0 0 -40"
           rotation="-90 0 0"
           width="100" height="100"
           class="cliquable"
           static-body>
  </a-plane>

  <a-sphere position="0 5 -10" radius="0.3" color="#AAA" dynamic-body></a-sphere>
  <a-box position="1 6 -10" depth="0.4" height="0.4" width="0.4" color="#BBB" dynamic-body></a-box></a-scene>
    
    <a-scene scale="3 3 3">
      <a-entity light="type: ambient; intensity: 4" position= "3 5 2"></a-entity>
    
        <a-entity camera 
          position="0 1.6 0" 
          wasd-controls 
          look-controls ></a-entity>
  <a-entity cursor="fuse: false"
            raycaster="objects: .cliquable"
            position="0 0 -1"
            geometry="primitive: ring; radiusInner: 0.01; radiusOuter: 0.02"
            material="color: black; shader: flat">
  </a-entity>

<!-- Joueur -->
<a-entity id="player" position="0 0 -10" player-controller>
<!-- Corps du joueur (optionnel, visible si vous voulez) -->
<a-cylinder radius="0.25" height="1.7" position="0 0.85 0" opacity="0.0"></a-cylinder>
</a-entity>
          
<!-- Caméra 3e personne -->
<a-entity id="camRig"
          third-person-camera="target: #player; distance: 4; height: 1.8; sensitivity: 0.12;">
<a-camera></a-camera>
<!-- Cursor pour clic souris -->
  <a-entity id="cursor"
            cursor="fuse:false"
            raycaster="objects: .cliquable"
            position="0 0 -1"
            geometry="primitive:ring; radiusInner:0.01; radiusOuter:0.02"
            material="color:black; shader:flat">
  </a-entity>
</a-entity>
          
  <!-- Assets pour les textures -->
      <a-assets>
         <img id="Kukulcan" src="https://cdn.glitch.global/f0de172e-e436-49ee-ae2c-94d671d266ff/TCom_Rock_CliffVolcanic2_header.jpg?v=1746379477374">
         <img id="stone" src="https://cdn.glitch.global/f0de172e-e436-49ee-ae2c-94d671d266ff/Stone.JPG?v=1746379176283">
         <img id= "grass" src= "https://cdn.glitch.global/f0de172e-e436-49ee-ae2c-94d671d266ff/pastoo.JPG?v=1746456645508">
         <img id="cenote" src="https://cdn.glitch.global/f0de172e-e436-49ee-ae2c-94d671d266ff/cenote.jpeg?v=1746456350032">
         <a-asset-item id="tree" src="https://cdn.glitch.global/f0de172e-e436-49ee-ae2c-94d671d266ff/tree .glb?v=1746454285573"></a-asset-item>  
         <a-asset-item id= "tzompantli" src="https://cdn.glitch.me/f0de172e-e436-49ee-ae2c-94d671d266ff/Tzompantli .glb?v=1746383332024"></a-asset-item>
         <a-asset-item id= "marche" scr="https://cdn.glitch.global/f0de172e-e436-49ee-ae2c-94d671d266ff/maya_temple .glb?v=1746452494044"></a-asset-item>
      </a-assets>


      

  <!-- Sol jungle -->
      <a-plane position="0 0 -40" rotation="-90 0 0" width="100" height="100" color="#228B22" src="#grass" scale="3 3 3"></a-plane>
      <a-plane position="0 0.06 -45" rotation="-90 0 0" width="15" height="20" color="#deb887" scale="3 3 3"></a-plane>
     
 <!-- Pyramide Maya : El Castillo -->
      <a-entity id="Castillo" position="0 0 -45" scale="3 3 3" class="cliquable">
            <a-box position="0 0.5 0" width="10" depth="10" height="1" src="#Kukulcan"></a-box>
            <a-box position="0 1.5 0"` width="9" depth="9" height="1" src="#Kukulcan"></a-box>
            <a-box position="0 2.5 0" width="8" depth="8" height="1" src="#Kukulcan"></a-box>
            <a-box position="0 3.5 0" width="7" depth="7" height="1" src="#Kukulcan"></a-box>
            <a-box position="0 4.5 0" width="6" depth="6" height="1" src="#Kukulcan"></a-box>
            <a-box position="0 5.5 0" width="5" depth="5" height="1" src="#Kukulcan"></a-box>
            <a-box position="0 6.5 0" width="4" depth="4" height="1" src="#Kukulcan"></a-box>
            <a-box position="0 7.5 0" width="3" depth="3" height="1" src="#Kukulcan"></a-box>
            <a-box position="0 8.5 0" width="2" depth="2" height="1" src="#Kukulcan"></a-box>
            <a-box position="0 9.5 0" width="1" depth="1" height="1" src="#Kukulcan"></a-box>
          </a-entity>
  


  <!-- Tzompantli -->
        <a-entity id="Tzompantli" gltf-model="#tzompantli" position="5 0 -180" scale="1 1 1" class="clicable"></a-entity>
      
        
  <!-- Temple des Guerriers -->
        <a-entity id="Temple des Guerriers" position="108 0 -143" scale="3 3 3" class="cliquable">
          <a-box position="0 0.5 0" width="10" depth="10" height="1" src="#stone"></a-box>
          <a-box position="0 1.5 0" width="9" depth="9" height="1" src="#stone"></a-box>
          <a-box position="0 2.5 0" width="8" depth="8" height="1" src="#stone"></a-box>
          <a-box position="0 3.5 0" width="7" depth="7" height="1" src="#stone"></a-box>
          <a-box position="0 4.5 0" width="6" depth="6" height="1" src="#stone"></a-box>
          <a-box position="0 5.5 0" width="5" depth="5" height="1" src="#stone"></a-box>
          <a-box position="0 6.5 0" width="4" depth="4" height="1" src="#stone"></a-box>
          <a-box position="0 7.5 0" width="3" depth="3" height="1" src="#stone"></a-box>
          <a-box position="0 8.5 0" width="2" depth="2" height="1" src="#stone"></a-box>
          <a-box position="0 9.5 0" width="1" depth="1" height="1" src="#stone"></a-box>
        </a-entity>

  <!-- Colonnade (deux rangées de 6 colonnes) -->
        <a-entity id="precolonnes" position="106 0 -65" scale="3 3 3">
            <a-cylinder position="-5 1 -15" radius="0.3" height="2" src="#stone"></a-cylinder>
            <a-cylinder position="-3 1 -15" radius="0.3" height="2" src="#stone"></a-cylinder>
            <a-cylinder position="-1 1 -15" radius="0.3" height="2" src="#stone"></a-cylinder>
            <a-cylinder position="1 1 -15" radius="0.3" height="2" src="#stone"></a-cylinder>
            <a-cylinder position="3 1 -15" radius="0.3" height="2" src="#stone"></a-cylinder>
            <a-cylinder position="5 1 -15" radius="0.3" height="2" src="#stone"></a-cylinder>
        </a-entity>
        <a-entity id="deuxcolonnes" position="106 0 -36" scale="3 3 3">
            <a-cylinder position="-5 1 -15" radius="0.3" height="2" src="#stone"></a-cylinder>
            <a-cylinder position="-3 1 -15" radius="0.3" height="2" src="#stone"></a-cylinder>
            <a-cylinder position="-1 1 -15" radius="0.3" height="2" src="#stone"></a-cylinder>
            <a-cylinder position="1 1 -15" radius="0.3" height="2" src="#stone"></a-cylinder>
            <a-cylinder position="3 1 -15" radius="0.3" height="2" src="#stone"></a-cylinder>
            <a-cylinder position="5 1 -15" radius="0.3" height="2" src="#stone"></a-cylinder>
        </a-entity>
      
    <!-- marche -->
        <a-entity id="mercado" gltf-model="#marche" position="33 0 -8" scale="1 1 1"></a-entity>

        <!-- El Caracol Observatory -->
      <a-entity id="Caracol" position="-108 0 62" scale="3 3 3" class="cliquable">
    <!-- Base carrée -->
        <a-box position="0 0.5 0" width="6" depth="6" height="1" src="#stone"></a-box>
        <a-box position="0 1.5 0" width="4.5" depth="4.5" height="1" src="#stone"></a-box>

    <!-- Observatoire circulaire -->
        <a-cylinder position="0 3 0" radius="1.5" height="2" src="#stone"></a-cylinder>
        <a-sphere position="0 4.5 0" radius="1.2" color="#bfa980"></a-sphere>

    <!-- Détail : porte -->
        <a-box position="0 2.5 1.5" width="0.8" height="1" depth="0.1" color="#333"></a-box>
      </a-entity>

        <!-- Temple des Jaguars -->
        <a-entity id="Jaguars" position="-118 0 -62" scale="3 3 3" class="clicable">
            <a-box position="0 0.5 0" width="6" depth="6" height="1" src="#stone"></a-box>
            <a-box position="0 1.5 0" width="4.5" depth="4.5" height="1" src="#stone"></a-box>
            <a-box position="0 2.5 0" width="3" depth="3" height="1" src="#stone"></a-box>
            <a-box position="0 4 0" width="2.5" height="1.5" depth="2.5" src="#stone"></a-box>
        </a-entity>
        <a-entity position="110 0 45" scale="3 3 3">
            <a-box position="0 0.5 0" width="6" depth="6" height="1" src="#stone"></a-box>
            <a-box position="0 1.5 0" width="4.5" depth="4.5" height="1" src="#stone"></a-box>
            <a-box position="0 2.5 0" width="3" depth="3" height="1" src="#stone"></a-box>
            <a-box position="0 4 0" width="2.5" height="1.5" depth="2.5" src="#stone"></a-box>
        </a-entity>

        <!-- Terrain de jeu de balle -->
        <a-entity id="pelota" position="-102 0 -167" scale="2 2 2" class="clicable">
            <a-box position="0 0.05 0" width="30" height="0.1" depth="6" color="#5a4e3c"></a-box>
            <a-box position="-15 2 0" width="0.5" height="4" depth="6" src="#stone"></a-box>
            <a-box position="15 2 0" width="0.5" height="4" depth="6" src="#stone"></a-box>
            <a-torus position="-14 3 0" radius="0.5" radius-tubular="0.1" rotation="0 0 90" color="#333"></a-torus>
            <a-torus position="14 3 0" radius="0.5" radius-tubular="0.1" rotation="0 0 90" color="#333"></a-torus>
        </a-entity>

        <a-entity id="pyramide" position="38 0 68" scale="3 3 3" class="clicable">
          <a-box position="0 0.5 0" width="6" depth="6" height="1" src="#stone"></a-box>
          <a-box position="0 1.5 0" width="4.5" depth="4.5" height="1" src="#stone"></a-box>
          <a-box position="0 2.5 0" width="3" depth="3" height="1" src="#stone"></a-box> 
    <!-- Temple au sommet -->
        <a-box position="0 3.75 0" width="2" depth="2" height="1.5" src="#stone"></a-box>
    <!-- Détails : colonnes du temple -->
        <a-cylinder position="0.9 3.25 0.9" radius="0.1" height="1" color="#8a7b68"></a-cylinder>
        <a-cylinder position="-0.9 3.25 0.9" radius="0.1" height="1" color="#8a7b68"></a-cylinder>
        <a-cylinder position="0.9 3.25 -0.9" radius="0.1" height="1" color="#8a7b68"></a-cylinder>
        <a-cylinder position="-0.9 3.25 -0.9" radius="0.1" height="1" color="#8a7b68"></a-cylinder>
      </a-entity>

        <!-- Ciel -->
        <assets>
          <a-asset-item id="cloud" src="https://cdn.glitch.global/f0de172e-e436-49ee-ae2c-94d671d266ff/cloud.glb?v=1746471359274"></a-asset-item>
        </assets>
        <a-sky color="#88ccff"></a-sky>
        <a-entity gltf-model="#cloud" position="8 123 27" scale="7 7 7"></a-entity>
        <a-entity gltf-model="#cloud" position="37 123 -180" scale="7 7 7"></a-entity>
        <a-entity gltf-model="#cloud" position="-111 123 -117" scale="7 7 7"></a-entity>
        <a-entity gltf-model="#cloud" position="-120 123 -4" scale="7 7 7"></a-entity>
        <a-entity gltf-model="#cloud" position="64 123 -62" scale="7 7 7"></a-entity>
      
    <!--Scene 1_guide--> 
        <a-assets><a-asset-item id="guide" src="https://cdn.glitch.global/f0de172e-e436-49ee-ae2c-94d671d266ff/man.glb?v=1746484247413"></a-asset-item></a-assets>
        <a-entity gltf-model="#guide" position="-10 0 -82" 
                scale="2 2 2" 
                rotation="0 180 0" 
                customiser-homme
                class="cliquable" faire-parler></a-entity>
    
  <!--bulle de texte--> 
      <a-entity id="bulle"
          position="0 2.2 -4"
          visible="false"
          class="cliquable">
      <a-plane color="#0000" opacity="0.7" width="3" height="0.8"></a-plane>
      <a-text id="bulle-text"
          value="o"
          align="center"
          color="#FFF"
          width="2.5"
          position="0 0 0.01">
      </a-text>
      </a-entity>
      
  <!-- curseur -->    
      <a-entity id="cursor" cursor="fuse: false" raycaster="objects: .cliquable" 
          position="0 0 -1" 
          geometry="primitive: ring; radiusInner: 0.01; radiusOuter: 0.02"
          material="color: black; shader: flat">
      </a-entity>
      <a-entity id="infoText" visible="false" position="0 2 -45">
      <a-plane width="4.5" height="2" color="#fff" opacity="0.9"></a-plane>
      <a-text id="infoTextValue" value="" color="#000" align="center" width="3.5" position="0 0.3 0.01"></a-text>
      <a-box id="closeButton" position="0 -0.6 0.01" width="1.2" height="0.4" depth="0.1" color="#c44"></a-box>
      <a-text value="Fermer" position="0 -0.6 0.02" align="center" color="#fff" width="2"></a-text>
      </a-entity>
      
      <a-entity camera position="0 1.6 0">
        <a-entity cursor></a-entity>
      </a-entity>
      
  <!-- COMPOSANTS SCRIPT -->
     <script>
  const guidephrases = [
    "Bonjour et bienvenue à la Ruta Maya, je vous montrerai une des villes les plus importantes et puissantes de la culture Maya.",
    "Chichen Itzá",
    "Je m’appelle Aj Koo et je serais ton guide.",
    "Suis-moi, je vais te faire découvrir les secrets de ma civilisation !"
  ];
  let indexPhrase = 0;

  AFRAME.registerComponent('customiser-homme', {
    init: function () {
      this.el.addEventListener('model-loaded', () => {
        const mesh = this.el.getObject3D('mesh');
        if (!mesh) return;
        let count = 0;
        mesh.traverse((node) => {
          if (node.isMesh) {
            if (count === 0) node.material.color.set("#AE703A");
            else if (count === 1) node.material.color.set("#6F4E37");
            else if (count === 2) node.material.color.set("#4B3621");
            else node.material.color.set("#CCCCCC");
            count++;
          }
        });
      });
    }
  });

  AFRAME.registerComponent('faire-parler', {
    init: function () {
      const guide = this.el;
      const bulle = document.querySelector('#bulle');
      const texte = document.querySelector('#bulle-text');

      // Affiche la première phrase au clic sur le guide
      guide.addEventListener('click', () => {
        indexPhrase = 0;
        texte.setAttribute('value', phrases[indexPhrase]);
        bulle.setAttribute('visible', 'true');
      });

      // Avance dans les phrases au clic sur la bulle
      bulle.addEventListener('click', () => {
        indexPhrase++;
        if (indexPhrase >= phrases.length) {
          indexPhrase = 0;
        }
        texte.setAttribute('value', phrases[indexPhrase]);
      });
    }
  });
  // === Bouton "Fermer" ===
document.addEventListener('DOMContentLoaded', () => {
  const closeButton = document.querySelector('#closeButton');
  if (closeButton) {
    closeButton.addEventListener('click', () => {
      document.querySelector('#infoText').setAttribute('visible', false);
    });
  }
});
    </script>

    <!--Scene 2_Kukulcan>
    <!-- Texte flottant (affiché au clic) -->
    <a-entity id="infoText" visible="false" position="0 2 -45">
      <a-plane width="4" height="1.5" color="#fff" opacity="0.9"></a-plane>
      <a-text id="infoTextValue" value="" color="#000" align="center" width="3.5" position="0 0 0.01"></a-text>
    </a-entity>

    <script>
  const Castillophrases = [
    "Vers l’an 435, la ville de Chichen Itzá est fondée.",
    "Le nom Chichen signifie \"bouche du puits\" et Itzá fait référence aux Itzáes, \"sorcières de l'eau\".",
    "Voici “El Castillo”. Un temple religieux et astronomique.",
    "Notre religion est polythéiste : nos dieux sont dans les étoiles, la pluie, la terre..."
  ];
  let phraseIndex = 0;

  AFRAME.registerComponent('show-info-step', {
    init: function () {
      this.el.addEventListener('click', () => {
        const infoEntity = document.querySelector('#infoText');
        const infoText = document.querySelector('#infoTextValue');
        const position = this.el.getAttribute('position');

        // Afficher le panneau si pas encore visible
        infoEntity.setAttribute('visible', true);
        infoEntity.setAttribute('position', {
          x: position.x,
          y: position.y + 3,
          z: position.z
        });

        // Afficher la phrase actuelle
        infoText.setAttribute('value', phrases[phraseIndex]);

        // Passer à la suivante, ou boucler
        phraseIndex = (phraseIndex + 1) % phrases.length;});}});

  // Activer le nouveau composant sur El Castillo
  document.addEventListener('DOMContentLoaded', () => {
    document.querySelector('#castillo').setAttribute('show-info-step', '');
  });
    </script>

  
  <!-- Scene 3_Tzompantli --> 
      
  <!-- Scene 4_Jeu de balle -->
      <script> const pelotaPhrases = [
    "Ici nous jouons au 'pok-ta-pok' (jeu de balle).",
    "C’est un jeu destiné à honorer les dieux et à équilibrer le monde.",
    "Le ballon représente le soleil, les murs représentent les limites du cosmos.",
    "C’est un rituel : le gagnant est sacrifié et offert aux dieux."
  ];
  let pelotaIndex = 0;

  AFRAME.registerComponent('show-info-pelota', {
    init: function () {
      this.el.addEventListener('click', () => {
        const infoEntity = document.querySelector('#infoText');
        const infoText = document.querySelector('#infoTextValue');
        const position = this.el.getAttribute('position');

        infoEntity.setAttribute('visible', true);
        infoEntity.setAttribute('position', {
          x: position.x,
          y: position.y + 3,
          z: position.z
        });

        infoText.setAttribute('value', pelotaPhrases[pelotaIndex]);
        pelotaIndex = (pelotaIndex + 1) % pelotaPhrases.length;
      });
    }
  });

  document.querySelector('#pelota').setAttribute('show-info-pelota', '');
</script>
      
  <!-- Scene 5_ Temple des Guerriers>


  <!--Scene 6 --> 
  <!--Scene 7 --> 
  
  <!--Scene 8_El Caracol--> 
      <script> const caracolPhrases = [
    "La culture Maya est caractérisée par le progrès technologique, surtout en astronomie et mathématique.",
    "Le Caracol est un observatoire, avec quatre ouvertures qui regardent un dieu ou une étoile.",
    "Les Mayas ont pu prédire la météo, les saisons et les éclipses."
  ];
  let caracolIndex = 0;

  AFRAME.registerComponent('show-info-caracol', {
    init: function () {
      this.el.addEventListener('click', () => {
        const infoEntity = document.querySelector('#infoText');
        const infoText = document.querySelector('#infoTextValue');
        const position = this.el.getAttribute('position');

        infoEntity.setAttribute('visible', true);
        infoEntity.setAttribute('position', {
          x: position.x,
          y: position.y + 3,
          z: position.z
        });

        infoText.setAttribute('value', caracolPhrases[caracolIndex]);
        caracolIndex = (caracolIndex + 1) % caracolPhrases.length;
      });
    }
  });

  document.querySelector('#Caracol').setAttribute('show-info-caracol', '');
  </script>
      
      
      
      
      
    </a-scene>
  
</body>

</html>

